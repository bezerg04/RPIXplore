(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[568],{9221:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/forum",function(){return t(5082)}])},6378:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});var a=t(5893),i=t(1664),r=t.n(i),n=t(3887);function l(e){let{activeLink:s}=e;return(0,a.jsxs)(n.wp,{fluid:!0,rounded:!0,children:[(0,a.jsxs)(n.wp.Brand,{as:r(),href:"/",children:[(0,a.jsx)("img",{src:"/_next/static/media/logo2.4e69c90b.png",className:"ml-1 mr-2",style:{height:"3.25rem"},alt:"RPIXplore Logo"}),(0,a.jsx)("span",{className:"InterBold text-2xl",children:"RPIXplore"})]}),(0,a.jsx)(n.wp.Toggle,{}),(0,a.jsxs)(n.wp.Collapse,{className:"mr-3",children:[(0,a.jsx)(n.wp.Link,{href:"/",active:"Home"===s,className:"Inter text-base",children:"Home"}),(0,a.jsx)(n.wp.Link,{as:r(),href:"/dorms",active:"Dorms"===s,className:"Inter text-base",children:"Dorms"}),(0,a.jsx)(n.wp.Link,{as:r(),href:"/forum",active:"Forum"===s,className:"Inter text-base",children:"Forum"}),(0,a.jsx)(n.wp.Link,{as:r(),href:"/resources",active:"Resources"===s,className:"Inter text-base",children:"Resources"})]})]})}},1222:function(e,s,t){"use strict";var a=t(5893);t(7294);var i=t(3887),r=t(3349),n=t(8959),l=t(1259);s.Z=()=>{let[e]=(0,r.F_)(n.I),s=async()=>{try{await (0,l.w7)(n.I)}catch(e){console.error("Error signing out:",e)}};return(0,a.jsxs)(i.wp,{children:[(0,a.jsx)(i.wp.Brand,{children:(0,a.jsx)("span",{className:"self-center whitespace-nowrap text-xl font-semibold",children:"Forum"})}),(0,a.jsxs)(i.wp.Collapse,{children:[(0,a.jsx)(i.wp.Link,{href:"/forum",children:"Home"}),!e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.wp.Link,{href:"/forum/signup",children:"Sign Up"}),(0,a.jsx)(i.wp.Link,{href:"/forum/login",children:"Login"})]}),e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.wp.Link,{href:"/forum/createpost",children:"Create Post"}),(0,a.jsx)(i.wp.Link,{as:"button",onClick:s,className:" hover:text-red-500",children:"Sign Out"})]})]})]})}},8959:function(e,s,t){"use strict";let a;t.d(s,{A:function(){return c},I:function(){return o},db:function(){return d}});var i=t(3977),r=t(1259),n=t(9828);let l={apiKey:"AIzaSyBrmvcTyLabGCX2dZf9rfNM0XPICO5JBEQ",authDomain:"rpixplore-b9aff.firebaseapp.com",projectId:"rpixplore-b9aff",storageBucket:"rpixplore-b9aff.appspot.com",messagingSenderId:"870529855224",appId:"1:870529855224:web:2478317c3f5caa9577d50d"};console.log("Initializing Firebase with config:",l),(0,i.C6)().length?(a=(0,i.Mq)(),console.log("Firebase app already initialized")):(a=(0,i.ZF)(l),console.log("Firebase app initialized"));let o=(0,r.v0)(a),d=(0,n.ad)(a),c=new r.hJ;console.log("Firebase Auth:",o),console.log("Firebase Firestore:",d),console.log("Firebase Provider:",c)},5082:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return h}});var a=t(5893),i=t(7294),r=t(6378),n=t(1222),l=t(3349),o=t(8959),d=t(6650),c=t(1163),m=t(3887),u=()=>{let[e]=(0,l.F_)(o.I),[s,t]=(0,i.useState)(""),[r,n]=(0,i.useState)(null),[u,p]=(0,i.useState)(null),h=(0,c.useRouter)(),x=async a=>{if(a.preventDefault(),!e){h.push("/forum/signup");return}if(""===s.trim()){p("Post content cannot be empty.");return}try{let a=null;if(r){let s=(0,d.iH)(o.storage,"images/".concat(e.uid,"/").concat(r.name));await (0,d.KV)(s,r),a=await (0,d.Jt)(s)}if(!(await fetch("/api/createPost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:e.uid,username:e.displayName||e.email,content:s,imageUrl:a,avatar:e.photoURL})})).ok)throw Error("Failed to create post");t(""),n(null),p(null)}catch(e){p(e.message)}};return(0,a.jsxs)("div",{className:"container mx-auto mt-8 p-4 border border-gray-200 rounded-lg shadow-md",children:[u&&(0,a.jsx)(m.bZ,{color:"failure",onDismiss:()=>p(null),children:(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Error:"})," ",u]})}),(0,a.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,a.jsx)("textarea",{value:s,onChange:e=>t(e.target.value),placeholder:"Write your post...",className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"5"}),(0,a.jsx)("input",{type:"file",onChange:e=>{let s=e.target.files[0];if(s){let e=new FileReader;e.onloadend=()=>{n(s)},e.readAsDataURL(s)}}}),r&&(0,a.jsx)("img",{src:URL.createObjectURL(r),alt:"Preview",className:"w-full h-auto mt-4"}),(0,a.jsx)(m.zx,{type:"submit",className:"w-full",color:"dark",children:e?"Post":"Sign Up to Post"})]})]})},p=()=>{var e;let[s,t]=(0,i.useState)([]),[r]=(0,l.F_)(o.I),[n,d]=(0,i.useState)(null);(0,i.useEffect)(()=>{!async function(){let e=await fetch("/api/getPosts");e.ok&&t(await e.json())}()},[]);let c=async e=>{var s;let a=(null===(s=e.likes)||void 0===s?void 0:s.includes(r.uid))?e.likes.filter(e=>e!==r.uid):[...e.likes||[],r.uid];await fetch("/api/updatePost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:e.id,updates:{likes:a}})}),t(s=>s.map(s=>s.id===e.id?{...s,likes:a}:s))},u=async e=>{var s;let a=(null===(s=e.dislikes)||void 0===s?void 0:s.includes(r.uid))?e.dislikes.filter(e=>e!==r.uid):[...e.dislikes||[],r.uid];await fetch("/api/updatePost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:e.id,updates:{dislikes:a}})}),t(s=>s.map(s=>s.id===e.id?{...s,dislikes:a}:s))},p=e=>{d(e)};return(0,a.jsxs)("div",{className:"container mx-auto mt-8",children:[s.map(e=>{var s,t,i,n,l,o;return(0,a.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg shadow-md mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[e.avatar&&(0,a.jsx)("img",{src:"data:image/svg+xml;utf8,".concat(encodeURIComponent(e.avatar)),alt:"Avatar",className:"w-12 h-12 rounded-full mr-4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.username}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:new Date((null===(s=e.createdAt)||void 0===s?void 0:s.seconds)*1e3).toLocaleString()})]})]}),(0,a.jsx)("p",{className:"mb-4",children:e.content}),e.imageUrl&&(0,a.jsx)("img",{src:e.imageUrl,alt:"Post Image",className:"w-full h-auto rounded-md"}),(0,a.jsxs)("div",{className:"flex items-center mt-4",children:[(0,a.jsxs)(m.zx,{onClick:()=>c(e),color:(null===(t=e.likes)||void 0===t?void 0:t.includes(null==r?void 0:r.uid))?"blue":"light",className:"mr-2",children:["Like (",(null===(i=e.likes)||void 0===i?void 0:i.length)||0,")"]}),(0,a.jsxs)(m.zx,{onClick:()=>u(e),color:(null===(n=e.dislikes)||void 0===n?void 0:n.includes(null==r?void 0:r.uid))?"red":"light",className:"mr-2",children:["Dislike (",(null===(l=e.dislikes)||void 0===l?void 0:l.length)||0,")"]}),(0,a.jsxs)(m.zx,{onClick:()=>p(e),color:"light",children:["Comments (",(null===(o=e.comments)||void 0===o?void 0:o.length)||0,")"]})]})]},e.id)}),n&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-end",children:(0,a.jsxs)("div",{className:"w-1/3 bg-white p-4 h-full overflow-y-scroll",children:[(0,a.jsx)("button",{onClick:()=>d(null),className:"text-gray-600 mb-4",children:"Close"}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:n.content}),n.imageUrl&&(0,a.jsx)("img",{src:n.imageUrl,alt:"Post Image",className:"w-full h-auto rounded-md mb-4"}),(0,a.jsx)("div",{className:"mb-4",children:null===(e=n.comments)||void 0===e?void 0:e.map((e,s)=>(0,a.jsxs)("div",{className:"p-2 border-b border-gray-200",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.username}),(0,a.jsx)("p",{children:e.text})]},s))}),r&&(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault();let s=e.target.comment.value,t=[...n.comments||[],{uid:r.uid,username:r.displayName||r.email,text:s,createdAt:new Date}];await fetch("/api/updatePost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:n.id,updates:{comments:t}})}),d(e=>({...e,comments:t})),e.target.comment.value=""},children:[(0,a.jsx)("textarea",{name:"comment",className:"w-full p-2 border border-gray-300 rounded-md mb-4",placeholder:"Write a comment..."}),(0,a.jsx)(m.zx,{type:"submit",color:"dark",children:"Post Comment"})]})]})})]})};function h(){return(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Z,{activeLink:"Forum"}),(0,a.jsx)(n.Z,{}),(0,a.jsx)(u,{}),(0,a.jsx)(p,{})]})}}},function(e){e.O(0,[445,556,16,636,664,275,295,650,888,928,179],function(){return e(e.s=9221)}),_N_E=e.O()}]);